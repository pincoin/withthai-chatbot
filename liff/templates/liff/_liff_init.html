<script>
    document.addEventListener('DOMContentLoaded', function () {
        liff.init({
            liffId: "{{ liffId }}"
        }).then(() => {
            console.log(liff.getVersion());
            console.log(liff.getLineVersion());
            console.log(liff.isInClient());
            console.log(liff.isLoggedIn());
            console.log(liff.getOS());
            console.log(liff.getLanguage());

            if (typeof runApp === 'function') {
                runApp();
            }
        }).catch((err) => {
            console.log(err);
            console.log('failed to initialize LIFF');
        });

        document.getElementById('closeWindowButton').addEventListener('click', function () {
            if (!liff.isInClient()) {
                sendAlertIfNotInClient();
            } else {
                liff.closeWindow();
            }
        });
    });
</script>